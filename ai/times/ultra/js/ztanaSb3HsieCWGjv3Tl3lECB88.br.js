function e(e){if(!e._compiled){const t=(e.atBreak?"[\\r\\n][\\t ]*":"")+(e.before?"(?:"+e.before+")":"");e._compiled=new RegExp((t?"("+t+")":"")+(/[|\\{}()[\]^$+*?.-]/.test(e.character)?"\\":"")+e.character+(e.after?"(?:"+e.after+")":""),"g")}return e._compiled}function t(t,n,r){let l=t.value||"",i="`",a=-1;for(;new RegExp("(^|[^`])"+i+"([^`]|$)").test(l);)i+="`";for(/[^ \r\n]/.test(l)&&(/^[ \r\n]/.test(l)&&/[ \r\n]$/.test(l)||/^`|`$/.test(l))&&(l=" "+l+" ");++a<r.unsafe.length;){const t=r.unsafe[a],n=e(t);let i;if(t.atBreak)for(;i=n.exec(l);){let e=i.index;10===l.charCodeAt(e)&&13===l.charCodeAt(e-1)&&e--,l=l.slice(0,e)+" "+l.slice(i.index+1)}}return i+l+i}function n(e){return e.length}function r(e){const t="string"==typeof e?e.codePointAt(0):0;return 67===t||99===t?99:76===t||108===t?108:82===t||114===t?114:0}t.peek=function(){return"`"};const l={enter:{table:function(e){const t=e._align;this.enter({type:"table",align:t.map((e=>"none"===e?null:e)),children:[]},e),this.setData("inTable",!0)},tableData:a,tableHeader:a,tableRow:function(e){this.enter({type:"tableRow",children:[]},e)}},exit:{codeText:function(e){let t=this.resume();this.getData("inTable")&&(t=t.replace(/\\([\\|])/g,c));this.stack[this.stack.length-1].value=t,this.exit(e)},table:function(e){this.exit(e),this.setData("inTable")},tableData:i,tableHeader:i,tableRow:i}};function i(e){this.exit(e)}function a(e){this.enter({type:"tableCell",children:[]},e)}function c(e,t){return"|"===t?t:e}function o(e){const l=e||{},i=l.tableCellPadding,a=l.tablePipeAlign,c=l.stringLength,o=i?" ":"|";return{unsafe:[{character:"\r",inConstruct:"tableCell"},{character:"\n",inConstruct:"tableCell"},{atBreak:!0,character:"|",after:"[\t :-]"},{character:"|",inConstruct:"tableCell"},{atBreak:!0,character:":",after:"-"},{atBreak:!0,character:"-",after:"[:|-]"}],handlers:{table:function(e,t,n,r){return h(function(e,t,n){const r=e.children;let l=-1;const i=[],a=t.enter("table");for(;++l<r.length;)i[l]=u(r[l],t,n);return a(),i}(e,n,r),e.align)},tableRow:function(e,t,n,r){const l=h([u(e,n,r)]);return l.slice(0,l.indexOf("\n"))},tableCell:s,inlineCode:function(e,n,r){let l=t(e,0,r);r.stack.includes("tableCell")&&(l=l.replace(/\|/g,"\\$&"));return l}}};function s(e,t,n,r){const l=n.enter("tableCell"),i=n.enter("phrasing"),a=function(e,t,n){const r=t.indexStack,l=e.children||[],i=[];let a=-1,c=n.before;r.push(-1);let o=t.createTracker(n);for(;++a<l.length;){const s=l[a];let h;if(r[r.length-1]=a,a+1<l.length){let n=t.handle.handlers[l[a+1].type];n&&n.peek&&(n=n.peek),h=n?n(l[a+1],e,t,{before:"",after:"",...o.current()}).charAt(0):""}else h=n.after;i.length>0&&("\r"===c||"\n"===c)&&"html"===s.type&&(i[i.length-1]=i[i.length-1].replace(/(\r?\n|\r)$/," "),c=" ",o=t.createTracker(n),o.move(i.join(""))),i.push(o.move(t.handle(s,e,t,{...o.current(),before:c,after:h}))),c=i[i.length-1].slice(-1)}return r.pop(),i.join("")}(e,n,{...r,before:o,after:o});return i(),l(),a}function h(e,t){return function(e,t={}){const l=(t.align||[]).concat(),i=t.stringLength||n,a=[],c=[],o=[],s=[];let h=0,u=-1;for(;++u<e.length;){const n=[],r=[];let l=-1;for(e[u].length>h&&(h=e[u].length);++l<e[u].length;){const a=null==(f=e[u][l])?"":String(f);if(!1!==t.alignDelimiters){const e=i(a);r[l]=e,(void 0===s[l]||e>s[l])&&(s[l]=e)}n.push(a)}c[u]=n,o[u]=r}var f;let g=-1;if("object"==typeof l&&"length"in l)for(;++g<h;)a[g]=r(l[g]);else{const e=r(l);for(;++g<h;)a[g]=e}g=-1;const p=[],d=[];for(;++g<h;){const e=a[g];let n="",r="";99===e?(n=":",r=":"):108===e?n=":":114===e&&(r=":");let l=!1===t.alignDelimiters?1:Math.max(1,s[g]-n.length-r.length);const i=n+"-".repeat(l)+r;!1!==t.alignDelimiters&&(l=n.length+l+r.length,l>s[g]&&(s[g]=l),d[g]=l),p[g]=i}c.splice(1,0,p),o.splice(1,0,d),u=-1;const b=[];for(;++u<c.length;){const e=c[u],n=o[u];g=-1;const r=[];for(;++g<h;){const l=e[g]||"";let i="",c="";if(!1!==t.alignDelimiters){const e=s[g]-(n[g]||0),t=a[g];114===t?i=" ".repeat(e):99===t?e%2?(i=" ".repeat(e/2+.5),c=" ".repeat(e/2-.5)):(i=" ".repeat(e/2),c=i):c=" ".repeat(e)}!1===t.delimiterStart||g||r.push("|"),!1===t.padding||!1===t.alignDelimiters&&""===l||!1===t.delimiterStart&&!g||r.push(" "),!1!==t.alignDelimiters&&r.push(i),r.push(l),!1!==t.alignDelimiters&&r.push(c),!1!==t.padding&&r.push(" "),!1===t.delimiterEnd&&g===h-1||r.push("|")}b.push(!1===t.delimiterEnd?r.join("").replace(/ +$/,""):r.join(""))}return b.join("\n")}(e,{align:t,alignDelimiters:a,padding:i,stringLength:c})}function u(e,t,n){const r=e.children;let l=-1;const i=[],a=t.enter("tableRow");for(;++l<r.length;)i[l]=s(r[l],0,t,n);return a(),i}}export{l as gfmTableFromMarkdown,o as gfmTableToMarkdown};